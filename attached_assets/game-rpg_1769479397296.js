// game-rpg.js - Ù†Ø¸Ø§Ù… RPG Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
let handler = async (m, { conn, args, usedPrefix }) => {
  let user = global.db.data.users[m.sender];
  
  // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
  if (!user.level) user.level = 1;
  if (!user.xp) user.xp = 0;
  if (!user.coins) user.coins = 500;
  if (!user.characters) user.characters = [];

  const action = args[0];

  // Ø­Ø³Ø§Ø¨ XP Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ
  const xpNeeded = user.level * 100;
  const xpProgress = (user.xp / xpNeeded * 100).toFixed(1);

  // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª RPG
  if (!action || action === 'Ø¹Ø±Ø¶' || action === 'info') {
    let message = `â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®
â”ƒ  âš”ï¸ *Ù†Ø¸Ø§Ù… RPG* âš”ï¸
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

ğŸ‘¤ *Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:* @${m.sender.split('@')[0]}

â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®
â”ƒ  ğŸ“Š *Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ÙˆØ§Ù„Ø®Ø¨Ø±Ø©*
â”ƒ  â­ Ø§Ù„Ù…Ø³ØªÙˆÙ‰: ${user.level}
â”ƒ  âœ¨ Ø§Ù„Ø®Ø¨Ø±Ø©: ${user.xp}/${xpNeeded}
â”ƒ  ğŸ“ˆ Ø§Ù„ØªÙ‚Ø¯Ù…: ${xpProgress}%
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®
â”ƒ  ğŸ’° *Ø§Ù„Ù…ÙˆØ§Ø±Ø¯*
â”ƒ  ğŸ’ Ø§Ù„Ø¹Ù…Ù„Ø§Øª: ${user.coins}
â”ƒ  ğŸ´ Ø§Ù„Ø´Ø®ØµÙŠØ§Øª: ${user.characters.length}
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

ğŸ’¡ *Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù…ØªØ§Ø­Ø©:*
\`${usedPrefix}rpg Ø±Ù‚ÙŠ\` - Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ (${xpNeeded - user.xp} XP Ù…ØªØ¨Ù‚ÙŠØ©)
\`${usedPrefix}ÙŠÙˆÙ…ÙŠ\` - Ù…ÙƒØ§ÙØ£Ø© ÙŠÙˆÙ…ÙŠØ©
\`${usedPrefix}Ø¬Ø§ØªØ´Ø§\` - Ø³Ø­Ø¨ Ø´Ø®ØµÙŠØ§Øª`;

    return m.reply(message, null, { mentions: [m.sender] });
  }

  // Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
  if (action === 'Ø±Ù‚ÙŠ' || action === 'levelup' || action === 'upgrade') {
    if (user.xp < xpNeeded) {
      return m.reply(`âŒ *Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ XP ÙƒØ§ÙÙŠØ©!*

âœ¨ Ù„Ø¯ÙŠÙƒ: ${user.xp} XP
ğŸ“Š ØªØ­ØªØ§Ø¬: ${xpNeeded} XP
âš ï¸ ÙŠÙ†Ù‚ØµÙƒ: ${xpNeeded - user.xp} XP

ğŸ’¡ *ÙƒÙŠÙ ØªØ­ØµÙ„ Ø¹Ù„Ù‰ XP:*
â€¢ Ù‚Ø§ØªÙ„ Ø§Ù„Ø²Ø¹Ù…Ø§Ø¡ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
â€¢ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø¨Ø§Ù†ØªØ¸Ø§Ù…
â€¢ Ø´Ø§Ø±Ùƒ ÙÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«`);
    }

    // Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
    user.level += 1;
    user.xp -= xpNeeded;
    
    // Ù…ÙƒØ§ÙØ£Ø© Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
    const coinReward = user.level * 50;
    user.coins += coinReward;

    let message = `â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®
â”ƒ  ğŸ‰ *Ø§Ø±ØªÙ‚ÙŠØª!* ğŸ‰
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

â­ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯: **${user.level}**
ğŸ’° Ù…ÙƒØ§ÙØ£Ø©: +${coinReward} Ø¹Ù…Ù„Ø©

â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®
â”ƒ  ğŸ“Š *Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªÙƒ*
â”ƒ  ğŸ’ Ø§Ù„Ø¹Ù…Ù„Ø§Øª: ${user.coins}
â”ƒ  âœ¨ XP Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${user.xp}
â”ƒ  ğŸ“ˆ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ: ${user.level * 100} XP
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

âœ¨ Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„ØªÙ‚Ø¯Ù… Ù„ÙØªØ­ Ù…Ù…ÙŠØ²Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©!`;

    m.reply(message);
  }
}

handler.help = ['rpg'];
handler.tags = ['game'];
handler.command = /^(rpg|Ø§Ø± Ø¨ÙŠ Ø¬ÙŠ)$/i;

export default handler;